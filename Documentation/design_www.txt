URL naming
----------

### Unstable endpoints
/$LISTNAME/?r=$GIT_COMMIT                       -> HTML only
/$LISTNAME/atom.xml                             -> Atom feed

#### Optional, relies on Search::Xapian
/$LISTNAME/t/$MESSAGE_ID/                       -> HTML content of thread
/$LISTNAME/t/$MESSAGE_ID/atom                   -> Atom feed for thread
/$LISTNAME/t/$MESSAGE_ID/mbox.gz                -> gzipped mbox of thread

### Stable endpoints
/$LISTNAME/m/$MESSAGE_ID/                       -> HTML content (short quotes)
/$LISTNAME/m/$MESSAGE_ID                        -> 301 to above
/$LISTNAME/m/$MESSAGE_ID/raw                    -> raw mbox
/$LISTNAME/f/$MESSAGE_ID/                       -> HTML content (full quotes)
/$LISTNAME/f/$MESSAGE_ID                        -> 301 to above
/$LISTNAME/f/$MESSAGE_ID/raw (*)                -> 301 to ../m/$MESSAGE_ID/raw

### Legacy endpoints (may be ambiguous given Message-IDs with similar suffies)
/$LISTNAME/m/$MESSAGE_ID.html                   -> 301 to $MESSAGE_ID/
/$LISTNAME/m/$MESSAGE_ID.txt                    -> 301 to $MESSAGE_ID/raw
/$LISTNAME/f/$MESSAGE_ID.html                   -> 301 to $MESSAGE_ID/
/$LISTNAME/f/$MESSAGE_ID.txt (*)                -> 301 to ../m/$MESSAGE_ID/raw


FIXME: we must refactor/cleanup/add tests for most of our CGI before
adding more endpoints and features.

(*) These URLs were never linked, but only exist as a convenience to folks
    who edit existing URLs

Encoding notes
--------------

Raw HTML and XML should only contain us-ascii characters which render
to UTF-8.

Plain text (raw message) endpoints display in the original encoding(s)
of the original email.

Guidelines for using limited HTML
---------------------------------
We mainly use HTML for linking pages together with <a>.
We also set <title> to make window management easier.

We favor <pre>-formatted text since public-inbox is intended as a place
to share and discuss patches and code.  Unfortunately, long paragraphs
tends to be less readable with fixed-width serif fonts which GUI
browsers default to.  So perhaps we will add different endpoints for
variable-width fonts.

* No graphics, images, or icons at all.  We tolerate, but do not
  encourage the use of GUIs.

* No setting colors or font sizes, power to users to decide those.

* No JavaScript. JS is historically too buggy and insecure, and we will
  never expect our readers to do either of the following:
  a) read and audit all our code for on every single page load
  b) trust us and and run code without reading it

* We only use CSS for one reason: wrapping pre-formatted text
  This is necessary because unfortunate GUI browsers tend to be
  prone to layout widening.  w3m is fine here without CSS :)
  No other CSS is allowed, especially with scary things like:

	http://thejh.net/misc/website-terminal-copy-paste
