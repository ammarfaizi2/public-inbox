public-inbox (server-side) installation
---------------------------------------

This is for folks who want to setup their own public-inbox instance.
Clients should use normal git-clone/git-fetch, or NNTP clients
if they want to import mail into their personal inboxes.

public-inbox is developed on Debian GNU/Linux systems and will
never depend on packages outside of the "main" component of
the "stable" distribution, currently Debian 9.x ("stretch")

Most packages are available in other GNU/Linux distributions;
and FreeBSD support can happen.

TODO: this still needs to be documented better,
also see the scripts/ and sa_config/ directories in the source tree

Requirements
------------

public-inbox requires a number of other packages to access its full
functionality.  The core tools are, of course:

* Git (1.8.0+, 2.6+ for writing v2 repositories)
* Perl 5.10.1+
* SQLite (needed for Xapian use)

To accept incoming mail into a public inbox, you'll likely want:

* MTA - postfix is recommended (for public-inbox-mda)
* SpamAssassin (spamc/spamd)   (for public-inbox-watch/public-inbox-mda)

Beyond that, there is a long list of Perl modules required, starting with:

* Date::Parse                   deb: libtimedate-perl
                                rpm: perl-Time-ParseDate

* Email::MIME                   deb: libemail-mime-perl
                                rpm: perl-Email-MIME

* Email::MIME::ContentType      deb: libemail-mime-contenttype-perl
                                rpm: perl-Email-MIME-ContentType

* Encode::MIME::Header          deb: libencode-perl
                                rpm: perl-Encode

* Plack                         deb: libplack-perl
                                rpm: perl-Plack, perl-Plack-Test,
                                (for HTML/Atom generation)

* URI::Escape                   deb: liburi-perl
                                rpm: perl-URI
                                (for HTML/Atom generation)

Where "deb" indicates package names for Debian-derived distributions and
"rpm" is for RPM-based distributions (only known to work on Fedora).

Numerous optional modules are likely to be useful as well:

  - Search::Xapian             deb: libsearch-xapian-perl
                               rpm: perl-Search-Xapian
                               (for NNTP service or gzipped mbox over HTTP)

  - IO::Compress::Gzip         deb: perl-modules (or libio-compress-perl)
                               rpm: perl-PerlIO-gzip
                               (for gzipped mbox over HTTP)

  - DBI                        deb: libdbi-perl
                               rpm: perl-DBI
                               (for gzipped mbox over HTTP)

  - DBD::SQLite                deb: libdbd-sqlite3-perl
                               rpm: perl-DBD-SQLite
                               (for NNTP service or gzipped mbox over HTTP)

  - Net::Server                deb: libnet-server-perl
                               rpm: perl-Net-Server
                               (for HTTP/NNTP servers as standalone daemons,
                                not needed as systemd services)

  - Filesys::Notify::Simple    deb: libfilesys-notify-simple-perl
                               rpm: perl-Filesys-Notify-Simple
                               (for public-inbox-watch)

  - Inline::C[7]               deb: libinline-c-perl
                               (speeds up spawning of git(1) on Linux
                                (see public-inbox-daemon(8))

  - Plack::Middleware::ReverseProxy

                               deb: libplack-middleware-reverseproxy-perl
                               rpm: perl-Plack-Middleware-ReverseProxy
                               (ensures redirects are correct when running
                                behind nginx or Varnish)

  - Plack::Middleware::Deflater

                               deb: libplack-middleware-deflater-perl
                               rpm: perl-Plack-Middleware-Deflater
                               (saves bandwidth on responses)

  - Socket6                    deb: libsocket6-perl
                               rpm: perl-Socket6
                               (pulled in by SpamAssassin and Net::Server,
                                only necessary if using IPv6 with
                                Plack::Middleware::AccessLog or similar
                                on Perl <= 5.12)

  - Crypt::CBC                 deb: libcrypt-cbc-perl
                               (for the rarely-used PublicInbox::Unsubscribe)

On Fedora systems, you'll probably also end up wanting
perl-Test-HTTP-Server-Simple, perl-Devel-Peek, and perl-IPC-Run to run the
test suite.  On Debian systems, libxml-feed-perl and libipc-run-perl
will aid in running the test suite (XML::Feed and IPC::Run respectively,
on CPAN).

standard MakeMaker installation (Perl)
--------------------------------------

Once the dependencies are installed, you should be able to build and
install the system (into /usr/local) with:

        perl Makefile.PL
        make
        make test
        make install # root permissions may be needed

When installing Search::Xapian, make sure the underlying Xapian
installation is not affected by an index corruption bug:

        https://bugs.debian.org/808610

For Debian 8.x (jessie), this means using Debian 8.5 or later.

public-inbox will never store unregeneratable data in Xapian
or any other search database we might use; Xapian corruption
will not destroy critical data.

See the public-inbox-overview(7) man page for the next steps once the
installation is complete.

Copyright
---------

Copyright 2013-2019 all contributors <meta@public-inbox.org>
License: AGPL-3.0+ <https://www.gnu.org/licenses/agpl-3.0.txt>
